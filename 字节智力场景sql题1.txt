I、智力题
一.100个苹果，两个人拿，一次只能拿1-5个，怎么保证自己一定能拿到最后一个?
    无论对方拿几个，你都可以选择相应的数字，把你们俩一个回合的球数凑成 6
    所以，你先拿之后剩6的倍数，就赢定了，无论他怎么拿，你都给他凑成6个，最后剩6个，他无论怎么拿，你拿剩下的就赢
    100 = 6 * 16 + 4
    所以，你应该先拿 4个。

二、有32块石头,重量各不同,用一架天平（无砝码）只称31次,能称出第一,第二重的石头吗?怎么称?
    1.先分16组,每组两个,将每组的两个放天平两边,把每组的重的挑出来.可以挑出16个.
    2.再将这16个分8组,重复步骤1,挑出8个.
    3.再将这8个重的分4组,重复步骤1,挑出4个.
    4.再将这4个分2组,重复步骤1,挑出2个,
    5.最后称一次,分出第一、第二重的石头.
    称的次数为16+8+4+2+1=31

三、64匹马,8个赛道,找出跑得最快的4匹马
    https://xvideos.blog.csdn.net/article/details/103807085

四、一硬币，一面向上概率0.7，一面0.3，如何公平？
    抛两次，正反 A胜， 反正 B胜。

五、两根香，一根烧完1小时，如何测量15分钟?
    开始时一根香两头点着，一根香只点一头，两头点着的香烧完说明过去了半小时，这时将只点了一头的香另一头也点着，从这时开始到烧完就是15分钟。

六、圆桌硬币问题：两个人轮流往一张圆桌上放硬币（硬币须全部在桌面上），当一方没有位置可放的时候，另一方获胜。
    问是否有一种策略可以让判断是先手获胜还是后手获胜？如果有，策略是什么？

    使用对称原理，如果先手将硬币放在圆桌的中心，那么当后手每放一枚硬币的时候，先手都可以找到以中心硬币为对称点的硬币放置位置。
        因此先手获胜的策略是：在圆桌中心放置一枚硬币，然后当后手没放一枚硬币的时候，找到对称的位置，放置硬币，即可。

七、坐标系中有一个球桌，四个角坐标：(0,0), (0,4), (2,4), (2,0)。一颗球在(1,1)，请问从哪些角度可以射入洞内(可无限次碰撞)？
    将这个桌面在这个平面无限延展，可类比成无限张球桌紧密放置,那么每一个和球洞的连线都是合法路径

八、54张扑克牌，平均分成3份，大小王在一份的概率？
    首先大王一定会在某一份中，然后要计算这一份中还要包含小王的概率。去掉大王还剩53张牌，这一份还可以分17张牌，小王在这17张牌的概率是17/53。
九、只有两个无刻度的水桶，一个可以装6L水，一个可以装5L水，如何在桶里装入3L的水
    提示：这个问题的本质就是利用两个水桶的已知容量倒来倒去，问题的解法并不唯一。
    先将5L的桶装满，将5L的桶的水倒入6L的桶中。这时5L的桶是空的，6L的桶中有5L的水
    再将5L的桶装满，倒入6L的桶中。这时5L的桶有4L的水，6L的桶是满的
    将6L的桶中的水倒掉，5L的桶的水倒入6L的桶中。这时5L的桶是空的，6L的桶中有4L的水
    将5L的桶装满，倒入6L的桶中。这时5L的桶还有3L的水，6L的桶是满的。

十、1000瓶药水里面只有1瓶是有毒的，毒发时间为24个小时，问需要多少只老鼠才能在24小时后试出那瓶有毒。
    为了简化问题，可以先假设有只有8瓶药水，其中有一瓶有毒，根据公式需要3个老鼠
    先将瓶子进行编号为0-7号，用位数表示老鼠，如下图，


    将4、5、6、7号药水混合到一起喂给老鼠1，将2，3，6，7号药水混合喂给老鼠2，将1、3、5、7药水混合喂给老鼠3，观察老鼠是否中毒。
    中毒的老鼠标号为1，未中毒的老鼠标号为0，将三只老鼠标号组合到一起即为有毒药水的标号。
    例如，第老鼠1中毒，老鼠2未中毒，老鼠3中毒。那么三只老鼠的二进制表示为101，即5号药水有毒。因为老鼠1中毒，说明4、5、6、7号药水中含有毒的药水。老鼠2未中毒，说明2、3、6、7无毒。老鼠3中毒，说明1、3、5、7中有一瓶有毒。所以有毒的为5号药水，其实和直接将二进制转化为十进制的结果是一样的。

    回到正题，如果有1000瓶药水，则需要10只老鼠，因为10位二进制足以表示0-999。
十一、家里有两个孩子，一个是女孩，另一个也是女孩的概率是多少？
   题目多少有些歧义，面试时说清楚就行了。

   已知家里有两个孩子Ａ和Ｂ，其中一个是女孩，关键问题就在其中一个是女陔这句话上。
   1如果你理解为这个是指定了一个孩子为女孩，例如Ａ为女孩，那么Ｂ也是女孩的概率显然为二分之一。
   2如果你理解为Ａ或Ｂ有一个孩子是女孩，问另一个孩子也是女陔的概率，这就是三分之一了。因为两个孩子的性别只有男男、男女、女男、女女四种组合，男男被排除了，剩下三种组合均符合题意，所以是三分之一。

   其实，题目本身应该是第二种理解的意思，告诉你了有一个是女孩并未明确说哪个是。但很多人看到题目就会先入为主，先指定了一个孩子为女孩，那另一个孩子为女孩的概率肯定是二分之一了，这是不正确的。

十二、一共12个一样的小球， 其中只有一个重量与其它不一样(未知轻重)，给你一个天平，找出那个不同重量的球？
    这个问题的思想是采用分治的思想。
    将12个小球分为三组（因为分成两组不能找到重量不一样的球在哪组），为A组、B组、C组
    将三组球分别两两称重，找到重量和另外两组不同的那一组（只要有两组可以使天平平衡，重量不一致的球必然在第三组）。假设坏的球在C组
    将C组的球分成两组C1和C2，每组两个球，这时从A组和B组里找到两个正常的球，分别和C1和C2去称，天平不能平衡说明重量不一致的球就在哪组。假设在C1
    将C1组的球分别和正常的球去称，天平不平衡时就能找到重量与其他不一致的球。

十三、一个天平，9个砝码，一个轻，其他8个一样重，至少需要称几次才能找出轻的？
    将9个砝码分为三组，为A组、B组、C组。
    找出来的再分成3组。
    这样两次即可

十四、有10瓶药，每瓶有10粒药，其中有一瓶是变质的。好药每颗重1克，变质的药每颗比好药重0.1克。问怎样用天秤称一次找出变质的那瓶药？
    将这10瓶药标好号1-10。
    然后按照瓶子的标号取药，1号药瓶取1粒药，2号药瓶取2粒药，3号药瓶取3例药，以此类推，取完10瓶药一起放到天平上去称。
    如果没有变质的药，重量应该是55克，这时多出几克，几号药瓶就是变质的。例如55.3克，那么变质的药就是3号药瓶的。
十五、
    你有两个罐子，50个红色弹球，50个蓝色弹球，如何将这100个球放入到两个罐子，随机选出一个罐子取出的球为红球的概率最大？
    这个问题应该是这几道题中最简单的了，将一个红球放到一个罐子中，另一个罐子放49个红球和50个蓝球，
    这样随便选出一个罐子取出红球的概率是1/2 * 1 + 1/2 * 49 /（49+50），接近0.75。

十六、你现在有一根金条，有一个工人为你工作了七天，他们的工资是金条的七分之一，并且需要当天结清，你只能对金条切割两次，请问需要怎么做。
    这个问题和平时用的纸币金额是一个道理，将一根金条切割两次可以得到三根金条，这三根金条必须可以组合出1-7之间的任意金额。
    将金条分两次切成长度为1、2、4的金条即可。

    第一天，将长度为1的金条支付给工人。
    第二天，将长度为2的金条支付给工人，工人将长度为1的金条还给你。
    第三天，将长度为1的金条支付给工人
    第四天，将长度为4的金条支付给工人，工人将长度为1，2的金条还给你
    第五条，将长度为1的金条支付给工人
    第六条，将长度为2的金条支付给工人，工人将长度为1的金条还给你
    第七天，将长度为1的金条支付给工人

十七、有三个酒杯，其中两个大酒杯每个可以装8两酒，一个可以装3两酒。现在两个大酒杯都装满了酒，只用这三个杯子怎么把酒平均的分给4个人喝？
    这个问题就是用杯子倒来倒去，一共16两酒分给四个人，最后每个人都喝四两酒即可
    用三个数字表示三个杯子，最开始为880，即两个8两的杯子是满的，一个3两的杯子是空的。

    880—>853，这时A喝掉第三个杯子的三两酒变成850
    850—>823，这时B喝掉第二个杯子的二两变酒成803
    803—>830—>533—>560—>263—>281，A喝掉第三个杯子的一两酒变成280（A喝完了4两）
    280—>253—>550—>523—>820—>703—>730—>433—>460—>163—>181，这时C和D各喝一两酒变成080
    080—>053—>350—>323，这时B喝点第二个杯子的二两酒，C和D各喝三两酒，到此所有人都喝了四两酒

十八、在地球什么地方能够，往南走1公里，然后往东走1公里，再往北走1公里能回到原点？
    这个问题的本质就是往北走一公里和往南走一公里正好抵消，往东走一公里要回到原点。一共是2n个答案。
    我们只需要找到在哪里往东走一公里会回到原点呢？这样的点在地球上有无数个，主要集中在两个地方，即北极点附近和南极点附近。
    有一个周长为一公里的圆，圆心在北极点和南极点的连线上，只要站在这个圆上的任意一个点，向东或向西走一公里都会回到原点。如下图绿色的圆。

    所以这个点是距离南极1+1/(2*pi)的点，假设这个点为A点，先向南走一公里到达B点，向东走一公里还是B点（相当于绕了一圈），再向北走一公里回到A点。
    这时是假设这个圆的圆心就是南极点，圆的半径就是1/(2*pi)，因为地球非常大，这个圆的周长又只有一公里，这么假设是可以的。

    这时又有人说了，这个B点所在的圆还可以小一点，即一公里是这个圆的周长的整数倍，这样也是可以的，向东走一公里相当于绕了很多圈还是回到了原点。
    所以答案是距离南极点1+1/(2*pi*k)的点，都是可以的，k为正整数。

    还有一个答案就是北极点，很好理解，在北极点先向南走一公里，在向东走一公里，这时距离北极点还是一公里，在向被走一公里就回到北极点了。

十九、rand5()生成rand7()
    这里有个小技巧：(rand5()-1)*5 等概率的生成0，5，10，20
    res = (rand5()+1)*5+rand5() 等概率的生成0，1，2，3，4，5…24
    然后将其中的1-21映射成1-7，丢弃22-25,即res%7+1;

二十、两个人轮流抛硬币，正面获胜，先抛的人获胜的概率？
    A先，B后

    P(A) = 1/2 +      //A直接取胜
    	   1/2 * 1/2 * 1/2 +      // A1失败B1失败A2取胜
    	   1/2 * 1/2 * 1/2 * 1/2 *1/2  +    //A1失败B1失败A2失败B2失败A3取胜
    	   ...

    p = 1/2 + (1/2)^3 + (1/2)^5 + (1/2)^7 + ...
    等比数列求和
    p = 1/2 * (1 - (1/4)^n) / (1 - 1/4) = 2/3

二十一、系统中有几万个任务需要在各自的特定时刻触发执行，怎么做？
    使用 Quartz，或者使用这种思想。
II、场景题
一、让你设计一个微信发红包的api，你会怎么设计，不能有人领到的红包里面没钱，红包数值精确到分。
  api：
    传入参数有总钱数，分的份数，随机分还是等分。
    先判断钱数能不能分那么多份，这个直接用总钱数>=0.01*份数判断就可以了。
    然后根据分发策略，选择随机还是等分，
        随机的话假设一共有 N 元，一共有 K 个人，则可以每个人拿到的钱为 random(N - (K - 1) * 0.01)，然后更新N，直到最后一个人就直接 N。
        或随机的话就给额度在0.01和剩余平均值*2之间。最后一次取红包就有take all操作、
    等分的话直接除判断能不能除开，有余数就将余数加到最后一份里面。

  红包的架构设计：
    答：微信从财付通拉取金额数据过来，生成个数/红包类型/金额放到redis集群里，app端将红包ID的请求放入请求队列中，如果发现超过红包的个数，直接返回。
    根据红包的逻辑处理成功得到令牌请求，则由财付通进行一致性调用，通过像比特币一样，两边保存交易记录，交易后交给第三方服务审计，如果交易过程中出现不一致就强制回归。

   cache会抵抗无效请求，将无效的请求过滤掉，实际进入到后台的量不大。cache记录红包个数，原子操作进行个数递减，到0表示被抢光。

二、谁关注了我，我关注了谁，谁与我互相关注。表该如何设计，索引怎么建。查询语句怎么写？
    1、使用mysql实现
        粉丝关注表使用四列，主键id，userId，fansId，是否互相关注。用两行数据来保存互相的关注关系，这样查询起来更方便，用空间换时间。
        主键有主键索引，剩下的字段不适合建索引，因为字段重复太多。
    2、使用redis来实现
        因为这个表的字段太少，所以考虑使用redis来实现。用一个set存储每个用户的关注列表和粉丝列表，关注列表的键是“follow:" + 当前用户id,
        粉丝列表的键是”当前用户的id" + "follow", 这样很容易就能得到某个用户的所有粉丝和关注的人，相互关注的只需让两个set取交集即可。
三、高考成绩2000万数据，分数0-750，如何快速知道你的排名，如何知道任一分数排名？
    利用桶排序。将分数分成 0 - 150， 151 - 300， 301 - 450， 451 - 600， 601 - 750 共五个区间（每个区间内还可以再分），
        将 2000 万分数据按照成绩分到对应的成绩区间中。这样就可以快速查到对应分数的排名了。

III、大数据类场景题
    1、1亿个正整数,范围是0-42亿。求出现次数是2的数字，空间复杂度?
        使用位图bitMap 。位图是以 bit 位为单位进行数据存储，这样每个字节8个位就可以存储8个数字，普通的一个int占4个字节，32位，用了位图之后可以将空间节省32倍。
        开一个42亿大小的位图，将这一亿个数字存进数字大小对应的位置，一个bit每存进去一个数字，就将value+1,比如第一次存8，就将索引为8的位置的value置为1，第二次就置为2，存完之后搜索value为2的key是多少。

        申请512M的内存 512M=512*1024*1024B*8=4294967296比特(bit)。 这个空间可以装40亿了
        一个bit位代表一个int值
        读入40亿个数，设置相应的bit位，遇到一个数字，先看对应的bit是不是1，是1就找到了出现2次的数字，是0，就置它为1就好了。

    2.有一个IP地址库，假设有几十万条ip，如何判断某个ip地址是否在这个库中？
        思路一：分治法，将ip地址根据前三位分成256份，然后看这个ip地址对应的网段，只比对这个网段里面是否有这个ip，当然还可以继续分下去，根据数据量来决定分成多少份。
        思路二：位图，将每一条ip对应位图中的一个位，2^32次方(42亿多)个数据只需要512M空间。可以实现O(1)的时间搜索，O(n)的时间存储。
        思路三：布隆过滤器。布隆过滤器就是对多个 ip 通过多次 hash，将制定位置的标志设置为 1。在判断给定 ip 是否存在时，直接使用 ip 进行多次 hash，
            如果多次 hash 的索引所在值都为 1，那么存在。因此，布隆过滤器常用作垃圾短信、垃圾邮件的过滤机制（ps：布隆过滤器具有拒真、纳伪的特性）


    3.在一个文件中有 10G 个整数,乱序排列,要求找出中位数(内存限制为 2G)？
        第一步：要表示10G个整数，最少需要一个64位的数据空间。（10G = 5 * 2^31 > 2^32 )（32位整数范围是0 - 2^32 - 1，一共有4G种取值）
        第二步：分区间
            2G的内存，能够表示多少个64bit，就能分多少个区间。（一个区间 就表示 一个64bit的数据空间）
            区间数位：2G / 64bit = 256M 个区间。（2G内可以存256M个64位数）
        第三步：求区间表示范围
            32bit的整数最大值为2^32-1,所以区间的范围是2^32 / 256M = 16.（每个区间的所代表数的范围）
            即0 ~ 15 ，16 ~ 31，32 ~ 47，......（总共256M个)
            此时我们有 256M个区间，大小总共为256M * 64bit = 2G内存。
        第四步：遍历10G个整数。每读取一个整数就将此整数对应的区间+1。
        第五步：找出中位数所在的区间
            统计每个区间中整数的值。然后从第一个区间的整数值开始累加。当累加到5G时，停止。此时的区间便包含中位数。
            记下此区间所表示的范围，设为[a,a+15].并且记下此区间之前所有区间的累加和，设为m。释放掉除包含中位数区间的其他所有区间的内存。
        第六步：再次遍历10G个整数，统计出现在区间[a,a+15]中每个值的计数，有16个数值，按照a到a+15排序。设为n0,n1,n2,...n15
        第七步：当m+n0+n1+...+nx首次大于5G时，此时的 a+x 就是所求的中位数。
    4.10亿个数值，找最大的一万个
       大数的问题，你应该计算一下这个数组整体大小，然后询问数据是否重复，如果重复，先对文件hash，然后保存不同文件。
       设置一个buf，固定size，每次读一个buf大小的文件，维持一个大小为1万的小顶堆，遍历效率是o(nlogK)

IV、SQL题
    1.
      给出一个表T，有三列，分别为SNO，SUBJECT，SCORE
      SNO SUBJECT SCORE
      1001  语文          90
      1001  数学          40
      1002  语文          80
      请写出这样的一个SQL，查询出语文成绩及格，数学成绩不及格的学生的SNO

      答案1
            select sno from T
            where sno in (select sno from T where subect='数学' and score<60)
            and subect='yuwen' and score>=60
      答案2
            select a.sno from (select sno from t where subject='语文' and score>=60) a inner join
            (select sno from t where subject='数学' and score<60) b
            on a.sno=b.sno